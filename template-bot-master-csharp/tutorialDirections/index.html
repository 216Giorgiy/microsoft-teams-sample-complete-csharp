<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <h1>Directions</h1>
    <p>As the first section of the tutorial, this section will cover a few things that you will have to do over and over throughout this tutorial - namely updating and sideloading the manifest/manifest.json file (henceforth known as simply 'the manifest'). These two terms 'the manifest' and 'sideloading' will be used/done often. The manifest is a key part of integrating your app in Microsoft Teams because it is the place where you define for Teams what your app can do. Sideloading the manifest is the actual process of adding your app to Teams.</p>
    <p>First, although the app is currently running locally, all endpoints within Teams need to pass through an https endpoint. In order to get your local endpoint to pass through an https endpoint, you can use a tunnelling service such as ngrok (<a href="https://ngrok.com/">download ngrok</a>). The rest of this tutorial will assume you are using ngrok, but you can use whatever means you wish as long as your content is hosted on an https endpoint.</p>
    <p>To begin ngrok, open a cmd window and navigate to the location where you installed ngrok. There, make the call 'ngrok http 3979 --host-header=localhost'.</p>
    <br />
    <img style="width: 298.5px; height: 26.625px" src="/tutorialDirections/assets/ngrokCommand.png" />
    <br />
    <br />
    <p>Once ngrok is running keep it running and take note of the https endpoint it provides you. It should look something like: https://####abcd.ngrok.io NOTE: while ngrok is running, you can also navigate a browser to <a href="http://localhost:4040">http://localhost:4040</a> to see every request and response that passes through it.</p>
    <br />
    <img style="width: 578.25px; height: 192.75px" src="/tutorialDirections/assets/ngrokHttps.png" />
    <br />
    <br />
    <p>This https endpoint is what is known in this tutorial as your 'BASE_URI'. Although it will not do anything quite yet, in your Web.config file set your 'BaseUri' to this https endpoint by replacing the word 'NeedToSetThis'.</p>
    <p>The last part that is needed for your manifest is a 'REGISTERED_BOT_ID' or 'MicrosoftAppId'. You may not have a registered one yet, but that is ok - you can use 197ad85c-1111-2222-3333-62448d8d3912 as a temporary example.</p>
    <p>In the manifest replace all instances of '&lt;&lt;BASE_URI&gt;&gt;' with the https BASE_URI endpoint you received from ngrok.</p>
    <p>In the manifest replace all instances of '&lt;&lt;BASE_URI_DOMAIN&gt;&gt;' with the https BASE_URI endpoint you received from ngrok <b>WITHOUT</b> the 'https://' part e.g. ####abcd.ngrok.io</p>
    <p>In the manifest replace all instances of '&lt;&lt;REGISTERED_BOT_ID&gt;&gt;' with the temporary REGISTERED_BOT_ID - 197ad85c-1111-2222-3333-62448d8d3912</p>
    <p>Once you have made these changes, take a look at the 'staticTabs' section of the manifest. This is the new section that has been added, which describes the static tab you will add.</p>
    <p>Once you have looked over the changes, it is time to sideload the manifest (which adds your app to Teams). First, you must zip the manifest/manifest.json and manifest/bot_blue.png into the same file. Select both and choose to zip these files (do not add a new directory - just zip the two files - the manifest.json must stay named 'manifest.json'). Once you have the zip file (name of the zip file does not matter), follow the directions on how to sideload - <a href="https://msdn.microsoft.com/en-us/microsoft-teams/sideload">Sideloading a Manifest</a>.</p>
    <br />

    <h1>Features added</h1>
    <p>Change made to manifest/manifest.json in order to add a static tab.</p>
    <br />

    <h1>File Changes</h1>
    <p>Section added to manifest/manifest.json in order to add a static tab.</p>
    <br />

    <h1>To See the New Feature</h1>
    <p>Navigate to the '...' on the side. Navigate to your tutorial app.</p>
    <br />

    <h1>Next Feature to Add</h1>
    <p>Using the Microsoft Teams Javascript SDK within a tab.</p>
    <br />

    <h1>Setup and Sideload the Manifest</h1>
    <ul>
        <li>In the manifest replace all instances of '&lt;&lt;BASE_URI&gt;&gt;' with the https BASE_URI endpoint you received from ngrok.<br /><br /></li>
        <li>In the manifest replace all instances of '&lt;&lt;BASE_URI_DOMAIN&gt;&gt;' with the https BASE_URI endpoint you received from ngrok <b>WITHOUT</b> the 'https://' part e.g. ####abcd.ngrok.io<br /><br /></li>
        <li>In the manifest replace all instances of '&lt;&lt;REGISTERED_BOT_ID&gt;&gt;' with the your REGISTERED_BOT_ID (MicrosoftAppId in Web.config)</li>
    </ul>
    <br />

    <h1>To Progress to the Next Step</h1>
    <ul>
        <li>
            Navigate to the Team Explorer in Visual Studio.
            <br />
            <br />
            <img style="width: 333px; height: 177px" src="/tutorialDirections/assets/viewTeamExplorer.png" />
            <br />
            <br />
            <br />
        </li>
        <li>
            If you have not made any changes, simply move to the step that starts <i>"To move to the next section of the tutorial"</i>. If you have made changes, so there are no conflicts when changing branches, you will need to commit all of your changes <b>EXCEPT THOSE TO THE Web.config file</b>. Do this by first navigating to the 'Changes' section of the Teams Explorer.
            <br />
            <br />
            <img style="width: 352.5px; height: 426px" src="/tutorialDirections/assets/changes.png" />
            <br />
            <br />
            <br />
        </li>
        <li>
            Next, stage all of your changes <b>EXCEPT THOSE TO THE Web.config file</b>. You can do this by either selecting the files you want to commit, right clicking them, and selecting 'Stage', or you can click the plus button to stage everything, <b>BUT</b> you will then need to unstage your changes to the Web.config file by right clicking it and selecting 'Unstage'.
            <br />
            <br />
            <img style="width: 348px; height: 411.375px" src="/tutorialDirections/assets/stageChanges1.png" />
            <br />
            <br />
            <b>OR</b>
            <br />
            <br />
            <img style="width: 354px; height: 349.5px" src="/tutorialDirections/assets/stageChanges2.png" />
            <img style="width: 368.625px; height: 180.75px" src="/tutorialDirections/assets/stageChanges3.png" />
            <br />
            <br />
            <br />
        </li>
        <li>
            Finally, commit your changes by adding a message in the text box and clicking 'Commit Staged'.
            <br />
            <br />
            <img style="width: 348.375px; height: 364.5px" src="/tutorialDirections/assets/commitChanges.png" />
            <br />
            <br />
            <br />
        </li>
        <li>
            To move to the next section of the tutorial, navigate to the 'Branches' section of the Team Explorer and expand the remotes/origin directory.
            <br />
            <br />
            <img style="width: 330.75px; height: 374.625px" src="/tutorialDirections/assets/remoteBranches.png" />
            <br />
            <br />
            <br />
        </li>
        <li>
            Double click on the next branch in the order of the tutorial. This should create a new local branch based on that remote branch.
            <br />
            <br />
            <br />
        </li>
        <li>
            Press the play button to build and run the solution. If the next directions do not open automatically, then simply navigate <a href="http://localhost:3979">here</a>.
            <br />
            <br />
            <img style="width: 274.125px; height: 76.5px" src="/tutorialDirections/assets/buildAndRunSolution.png" />
            <br />
            <br />
            <br />
        </li>
    </ul>
</body>
</html>